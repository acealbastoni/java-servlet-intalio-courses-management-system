<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="css/admin.css">
       <style>
        .courses-container { margin: 20px; }
        .course { margin-bottom: 20px; }
        .modules { margin-left: 20px; }
    </style>
</head>
<body>
    <h1>Welcome Admin</h1>
    <p>Add new courses and modules here:</p>
    
    <div class="form-container">
        <h2>Add New Course</h2>
        <form id="addCourseForm" action="AddCourseServlet" method="post">
            <label for="courseName">Course Name:</label>
            <input type="text" id="courseName" name="courseName" required>
            <label for="courseDescription">Course Description:</label>
            <textarea id="courseDescription" name="courseDescription" required></textarea>
            <input type="submit" value="Add Course">
        </form>
    </div>

    <div class="form-container">
        <h2>Add New Module</h2>
        <form id="addModuleForm" action="AddModuleServlet" method="post">
            <label for="courseSelect">Select Course:</label>
            <select id="courseSelect" name="courseId" required>
                <!-- Options will be dynamically populated -->
                <option value="1">Course 1</option>
                <option value="2">Course 2</option>
            </select>
            <label for="moduleName">Module Name:</label>
            <input type="text" id="moduleName" name="moduleName" required>
            <label for="moduleDescription">Module Description:</label>
            <textarea id="moduleDescription" name="moduleDescription" required></textarea>
            <input type="submit" value="Add Module">
        </form>
    </div>





 <div class="courses-container">
        <h2>Existing Courses and Modules</h2>
    </div>

    <script>
        async function fetchModules() {
            try {
                const response = await fetch('FetchModulesServlet');
                if (!response.ok) {
                    throw new Error('Failed to fetch modules');
                }
                const data = await response.json();
                console.log('Fetched modules:', data); // Log the fetched data to the console
                alert(JSON.stringify(data, null, 2)); // Display the fetched data in an alert

                const transformedData = transformData(data);
                console.log('Transformed Data:', transformedData); // Log the transformed data to the console
                alert(JSON.stringify(transformedData, null, 2)); // Display the transformed data in an alert

                displayCourses(transformedData); // Display courses and modules on the page
            } catch (error) {
                console.error('Error fetching modules:', error);
            }
        }

        function transformData(data) {
            const courseMap = {
                1: "Java",
                2: "JavaScript",
                3: "Python",
                4: "C#"
            };

            const moduleMap = {};

            data.forEach(item => {
                const courseName = courseMap[item.courseID];
                if (!moduleMap[courseName]) {
                    moduleMap[courseName] = {};
                }

                if (!moduleMap[courseName][item.moduleName]) {
                    moduleMap[courseName][item.moduleName] = [];
                }

                moduleMap[courseName][item.moduleName].push(item.pdfFileName);
            });

            const result = Object.keys(moduleMap).map(courseName => {
                return {
                    courseName,
                    modules: Object.keys(moduleMap[courseName]).map(moduleName => {
                        return {
                            moduleName,
                            pdfFiles: moduleMap[courseName][moduleName]
                        };
                    })
                };
            });

            return result;
        }

        function displayCourses(courses) {
            const coursesContainer = document.querySelector('.courses-container');
            coursesContainer.innerHTML = '<h2>Existing Courses and Modules</h2>'; // Clear existing content

            courses.forEach(course => {
                const courseDiv = document.createElement('div');
                courseDiv.classList.add('course');

                const courseTitle = document.createElement('h3');
                courseTitle.textContent = course.courseName;
                courseDiv.appendChild(courseTitle);

                const courseDescription = document.createElement('p');
                courseDescription.textContent = `Description of ${course.courseName}`;
                courseDiv.appendChild(courseDescription);

                const modulesDiv = document.createElement('div');
                modulesDiv.classList.add('modules');

                const modulesTitle = document.createElement('h4');
                modulesTitle.textContent = 'Modules';
                modulesDiv.appendChild(modulesTitle);

                course.modules.forEach(module => {
                    const moduleParagraph = document.createElement('p');
                    moduleParagraph.textContent = `${module.moduleName}: ${module.pdfFiles.join(', ')}`;
                    modulesDiv.appendChild(moduleParagraph);
                });

                courseDiv.appendChild(modulesDiv);
                coursesContainer.appendChild(courseDiv);
            });
        }

        // Fetch and display modules on page load
        fetchModules();
    </script>






















<!--    <div class="courses-container">
        <h2>Existing Courses and Modules</h2>
        <div class="course">
            <h3>Course 1</h3>
            <p>Description of Course 1</p>
            <div class="modules">
                <h4>Modules</h4>
                <p>Module 1: Description of Module 1</p>
                <p>Module 2: Description of Module 2</p>
            </div>
        </div>
        <div class="course">
            <h3>Course 2</h3>
            <p>Description of Course 2</p>
            <div class="modules">
                <h4>Modules</h4>
                <p>Module 1: Description of Module 1</p>
				<p>Module 2: Description of Module 1</p>
				<p>Module 3: Description of Module 1</p>
				<p>Module 4: Description of Module 1</p>
            </div>
        </div>
    </div>

    <script>
        // JavaScript code to dynamically populate the course dropdown
        // and handle form submissions can be added here
    </script>-->
</body>
</html>
